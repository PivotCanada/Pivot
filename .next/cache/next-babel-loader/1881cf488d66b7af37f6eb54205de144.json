{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/dalyanparker/Programming/Applications/pivot-front-end/components/Profile/Follow.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useContext, useEffect, useState, useCallback } from \"react\";\nimport { UserContext } from \"../../contexts/UserContext\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Button } from \"@material-ui/core\"; // TODO : Refactor ...\n\nvar Follow = function Follow(_ref) {\n  _s();\n\n  var profile = _ref.profile;\n\n  var _useContext = useContext(UserContext),\n      user = _useContext.user,\n      setUser = _useContext.setUser,\n      authenticated = _useContext.authenticated;\n\n  var _useState = useState(false),\n      followed = _useState[0],\n      setFollowed = _useState[1];\n\n  var _useState2 = useState(true),\n      loading = _useState2[0],\n      setLoading = _useState2[1]; // TODO : FIX THIS !!!\n\n\n  var sameUser = user ? user._id == profile._id : false; // TODO : Fix this shittt ...\n\n  console.log(authenticated);\n  console.log(sameUser); //   console.log(profile);\n  //   console.log(user);\n\n  var checkFollowed = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(user, profile) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (user) {\n                user.following.forEach(function (u) {\n                  if (u._id === profile._id) {\n                    setFollowed(true);\n                  }\n                });\n                setLoading(false);\n              }\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function checkFollowed(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var onSubmit = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(user, profile, followed) {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              console.log(followed);\n              setFollowed(function (f) {\n                return !f;\n              });\n              _context4.next = 4;\n              return follow(user, profile, followed).then( /*#__PURE__*/function () {\n                var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(response) {\n                  return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                    while (1) {\n                      switch (_context3.prev = _context3.next) {\n                        case 0:\n                          console.log(response);\n\n                          if (response.status === \"success\") {\n                            // TODO : FIX THIS !!!\n                            setUser(response.data);\n                            followed_by(user, profile, followed).then( /*#__PURE__*/function () {\n                              var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(response) {\n                                return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                                  while (1) {\n                                    switch (_context2.prev = _context2.next) {\n                                      case 0:\n                                        console.log(response);\n\n                                        if (response.status === \"success\") {}\n\n                                      case 2:\n                                      case \"end\":\n                                        return _context2.stop();\n                                    }\n                                  }\n                                }, _callee2);\n                              }));\n\n                              return function (_x7) {\n                                return _ref5.apply(this, arguments);\n                              };\n                            }());\n                          }\n\n                        case 2:\n                        case \"end\":\n                          return _context3.stop();\n                      }\n                    }\n                  }, _callee3);\n                }));\n\n                return function (_x6) {\n                  return _ref4.apply(this, arguments);\n                };\n              }());\n\n            case 4:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function onSubmit(_x3, _x4, _x5) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var follow = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(user, profile, followed) {\n      var url, req;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              url = \"\";\n\n              if (followed) {\n                url = \"https://pivotinfo.herokuapp.com/api/users/unfollow/\".concat(user._id);\n              } else {\n                url = \"https://pivotinfo.herokuapp.com/api/users/follow/\".concat(user._id);\n              }\n\n              _context5.next = 4;\n              return fetch(url, {\n                method: \"PUT\",\n                mode: \"cors\",\n                // no-cors, *cors, same-origin,\n                // headers field seems to be essential ?\n                headers: {\n                  \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                  user: {\n                    _id: profile._id,\n                    firstname: profile.firstname,\n                    lastname: profile.lastname,\n                    photo: profile.photo,\n                    location: profile.location,\n                    industry: profile.industry,\n                    website: profile.website\n                  }\n                })\n              });\n\n            case 4:\n              req = _context5.sent;\n              _context5.next = 7;\n              return req.json();\n\n            case 7:\n              return _context5.abrupt(\"return\", _context5.sent);\n\n            case 8:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function follow(_x8, _x9, _x10) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  var followed_by = /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(user, profile, followed) {\n      var url, req;\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              url = \"\";\n\n              if (followed) {\n                url = \"https://pivotinfo.herokuapp.com/api/users/unfollowed/\".concat(profile._id);\n              } else {\n                url = \"https://pivotinfo.herokuapp.com/api/users/followed/\".concat(profile._id);\n              }\n\n              _context6.next = 4;\n              return fetch(url, {\n                method: \"PUT\",\n                mode: \"cors\",\n                // no-cors, *cors, same-origin,\n                // headers field seems to be essential ?\n                headers: {\n                  \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                  user: {\n                    _id: user._id,\n                    firstname: user.firstname,\n                    lastname: user.lastname,\n                    photo: user.photo,\n                    location: user.location,\n                    industry: user.industry,\n                    website: user.website\n                  }\n                })\n              });\n\n            case 4:\n              req = _context6.sent;\n              _context6.next = 7;\n              return req.json();\n\n            case 7:\n              return _context6.abrupt(\"return\", _context6.sent);\n\n            case 8:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function followed_by(_x11, _x12, _x13) {\n      return _ref7.apply(this, arguments);\n    };\n  }(); //   console.log(checkFollowed(user, profile));\n\n\n  useEffect(function () {\n    checkFollowed(user, profile);\n  }, [user]);\n\n  if (!authenticated || sameUser) {\n    return null;\n  } else {\n    var _ref8;\n\n    return __jsx(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      style: (_ref8 = {\n        width: 100,\n        textTransform: \"none\",\n        marginTop: 20\n      }, _defineProperty(_ref8, \"width\", \"100%\"), _defineProperty(_ref8, \"fontFamily\", \"Noto Sans, sans-serif\"), _defineProperty(_ref8, \"fontWeight\", 500), _defineProperty(_ref8, \"borderRadius\", 2), _ref8),\n      onClick: function onClick() {\n        return onSubmit(user, profile, followed);\n      },\n      type: \"button\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 7\n      }\n    }, followed ? \"UnFollow\" : \"Follow\");\n  }\n};\n\n_s(Follow, \"kZHafRmL7KCvvuMAXy1cseseNzg=\");\n\n_c = Follow;\nexport default Follow;\n\nvar _c;\n\n$RefreshReg$(_c, \"Follow\");","map":{"version":3,"sources":["/Users/dalyanparker/Programming/Applications/pivot-front-end/components/Profile/Follow.js"],"names":["useContext","useEffect","useState","useCallback","UserContext","makeStyles","Button","Follow","profile","user","setUser","authenticated","followed","setFollowed","loading","setLoading","sameUser","_id","console","log","checkFollowed","following","forEach","u","onSubmit","f","follow","then","response","status","data","followed_by","url","fetch","method","mode","headers","body","JSON","stringify","firstname","lastname","photo","location","industry","website","req","json","width","textTransform","marginTop"],"mappings":"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","sourcesContent":["import { useContext, useEffect, useState, useCallback } from \"react\";\nimport { UserContext } from \"../../contexts/UserContext\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Button } from \"@material-ui/core\";\n\n// TODO : Refactor ...\n\nconst Follow = ({ profile }) => {\n  const { user, setUser, authenticated } = useContext(UserContext);\n\n  const [followed, setFollowed] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  // TODO : FIX THIS !!!\n\n  const sameUser = user ? user._id == profile._id : false;\n\n  // TODO : Fix this shittt ...\n\n  console.log(authenticated);\n  console.log(sameUser);\n\n  //   console.log(profile);\n  //   console.log(user);\n\n  const checkFollowed = async (user, profile) => {\n    if (user) {\n      user.following.forEach((u) => {\n        if (u._id === profile._id) {\n          setFollowed(true);\n        }\n      });\n      setLoading(false);\n    }\n  };\n\n  const onSubmit = async (user, profile, followed) => {\n    console.log(followed);\n    setFollowed((f) => !f);\n\n    await follow(user, profile, followed).then(async (response) => {\n      console.log(response);\n      if (response.status === \"success\") {\n        // TODO : FIX THIS !!!\n        setUser(response.data);\n        followed_by(user, profile, followed).then(async (response) => {\n          console.log(response);\n          if (response.status === \"success\") {\n          }\n        });\n      }\n    });\n  };\n\n  const follow = async (user, profile, followed) => {\n    let url = \"\";\n\n    if (followed) {\n      url = `https://pivotinfo.herokuapp.com/api/users/unfollow/${user._id}`;\n    } else {\n      url = `https://pivotinfo.herokuapp.com/api/users/follow/${user._id}`;\n    }\n\n    const req = await fetch(url, {\n      method: \"PUT\",\n      mode: \"cors\", // no-cors, *cors, same-origin,\n      // headers field seems to be essential ?\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        user: {\n          _id: profile._id,\n          firstname: profile.firstname,\n          lastname: profile.lastname,\n          photo: profile.photo,\n          location: profile.location,\n          industry: profile.industry,\n          website: profile.website,\n        },\n      }),\n    });\n\n    return await req.json();\n  };\n\n  const followed_by = async (user, profile, followed) => {\n    let url = \"\";\n\n    if (followed) {\n      url = `https://pivotinfo.herokuapp.com/api/users/unfollowed/${profile._id}`;\n    } else {\n      url = `https://pivotinfo.herokuapp.com/api/users/followed/${profile._id}`;\n    }\n\n    const req = await fetch(url, {\n      method: \"PUT\",\n      mode: \"cors\", // no-cors, *cors, same-origin,\n      // headers field seems to be essential ?\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        user: {\n          _id: user._id,\n          firstname: user.firstname,\n          lastname: user.lastname,\n          photo: user.photo,\n          location: user.location,\n          industry: user.industry,\n          website: user.website,\n        },\n      }),\n    });\n\n    return await req.json();\n  };\n\n  //   console.log(checkFollowed(user, profile));\n\n  useEffect(() => {\n    checkFollowed(user, profile);\n  }, [user]);\n\n  if (!authenticated || sameUser) {\n    return null;\n  } else {\n    return (\n      <Button\n        variant=\"contained\"\n        color=\"primary\"\n        style={{\n          width: 100,\n          textTransform: \"none\",\n          marginTop: 20,\n          width: \"100%\",\n          fontFamily: \"Noto Sans, sans-serif\",\n          fontWeight: 500,\n          borderRadius: 2,\n        }}\n        onClick={() => onSubmit(user, profile, followed)}\n        type=\"button\"\n      >\n        {followed ? \"UnFollow\" : \"Follow\"}\n      </Button>\n    );\n  }\n};\n\nexport default Follow;\n"]},"metadata":{},"sourceType":"module"}