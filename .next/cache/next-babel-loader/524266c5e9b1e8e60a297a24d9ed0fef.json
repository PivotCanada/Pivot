{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport Cookie from \"js-cookie\";\nimport Router from \"next/router\";\nimport validateToken from \"../utils/authentication/validateToken\";\nimport fetchUser from \"../utils/general/fetchUser\";\n\nfunction useValidate(setUser, setAuthenticated, setLoading) {\n  var validateSession = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var token;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              setLoading(true);\n              token = Cookie.get(\"token\");\n\n              if (!(token !== undefined)) {\n                _context2.next = 7;\n                break;\n              }\n\n              _context2.next = 5;\n              return validateToken(token).then( /*#__PURE__*/function () {\n                var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(response) {\n                  return _regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          console.log(response);\n                          status = response.status;\n\n                          if (!(status === \"success\")) {\n                            _context.next = 7;\n                            break;\n                          }\n\n                          _context.next = 5;\n                          return fetchUser(response.data.userId).then(function (response) {\n                            setUser(response.data);\n                            setAuthenticated(true);\n                            setLoading(false);\n                          });\n\n                        case 5:\n                          _context.next = 11;\n                          break;\n\n                        case 7:\n                          setUser(null);\n                          setAuthenticated(false);\n                          setLoading(false);\n                          Cookie.remove(\"token\");\n\n                        case 11:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee);\n                }));\n\n                return function (_x) {\n                  return _ref2.apply(this, arguments);\n                };\n              }());\n\n            case 5:\n              _context2.next = 10;\n              break;\n\n            case 7:\n              setUser(null);\n              setAuthenticated(false);\n              setLoading(false);\n\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function validateSession() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return {\n    validateSession: validateSession\n  };\n}\n\nexport default useValidate;","map":{"version":3,"sources":["/Users/dalyanparker/Programming/Applications/pivot-front-end/hooks/useValidate.js"],"names":["Cookie","Router","validateToken","fetchUser","useValidate","setUser","setAuthenticated","setLoading","validateSession","token","get","undefined","then","response","console","log","status","data","userId","remove"],"mappings":";;AAAA,OAAOA,MAAP,MAAmB,WAAnB;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,OAAOC,aAAP,MAA0B,uCAA1B;AACA,OAAOC,SAAP,MAAsB,4BAAtB;;AAEA,SAASC,WAAT,CAAqBC,OAArB,EAA8BC,gBAA9B,EAAgDC,UAAhD,EAA4D;AAC1D,MAAMC,eAAe;AAAA,wEAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AACtBD,cAAAA,UAAU,CAAC,IAAD,CAAV;AACIE,cAAAA,KAFkB,GAEVT,MAAM,CAACU,GAAP,CAAW,OAAX,CAFU;;AAAA,oBAGlBD,KAAK,KAAKE,SAHQ;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAIdT,aAAa,CAACO,KAAD,CAAb,CAAqBG,IAArB;AAAA,qFAA0B,iBAAOC,QAAP;AAAA;AAAA;AAAA;AAAA;AAC9BC,0BAAAA,OAAO,CAACC,GAAR,CAAYF,QAAZ;AACAG,0BAAAA,MAAM,GAAGH,QAAQ,CAACG,MAAlB;;AAF8B,gCAG1BA,MAAM,KAAK,SAHe;AAAA;AAAA;AAAA;;AAAA;AAAA,iCAItBb,SAAS,CAACU,QAAQ,CAACI,IAAT,CAAcC,MAAf,CAAT,CAAgCN,IAAhC,CAAqC,UAACC,QAAD,EAAc;AACvDR,4BAAAA,OAAO,CAACQ,QAAQ,CAACI,IAAV,CAAP;AACAX,4BAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACAC,4BAAAA,UAAU,CAAC,KAAD,CAAV;AACD,2BAJK,CAJsB;;AAAA;AAAA;AAAA;;AAAA;AAU5BF,0BAAAA,OAAO,CAAC,IAAD,CAAP;AACAC,0BAAAA,gBAAgB,CAAC,KAAD,CAAhB;AACAC,0BAAAA,UAAU,CAAC,KAAD,CAAV;AACAP,0BAAAA,MAAM,CAACmB,MAAP,CAAc,OAAd;;AAb4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAA1B;;AAAA;AAAA;AAAA;AAAA,kBAJc;;AAAA;AAAA;AAAA;;AAAA;AAqBpBd,cAAAA,OAAO,CAAC,IAAD,CAAP;AACAC,cAAAA,gBAAgB,CAAC,KAAD,CAAhB;AACAC,cAAAA,UAAU,CAAC,KAAD,CAAV;;AAvBoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAfC,eAAe;AAAA;AAAA;AAAA,KAArB;;AA2BA,SAAO;AAAEA,IAAAA,eAAe,EAAfA;AAAF,GAAP;AACD;;AAED,eAAeJ,WAAf","sourcesContent":["import Cookie from \"js-cookie\";\nimport Router from \"next/router\";\nimport validateToken from \"../utils/authentication/validateToken\";\nimport fetchUser from \"../utils/general/fetchUser\";\n\nfunction useValidate(setUser, setAuthenticated, setLoading) {\n  const validateSession = async () => {\n    setLoading(true);\n    let token = Cookie.get(\"token\");\n    if (token !== undefined) {\n      await validateToken(token).then(async (response) => {\n        console.log(response);\n        status = response.status;\n        if (status === \"success\") {\n          await fetchUser(response.data.userId).then((response) => {\n            setUser(response.data);\n            setAuthenticated(true);\n            setLoading(false);\n          });\n        } else {\n          setUser(null);\n          setAuthenticated(false);\n          setLoading(false);\n          Cookie.remove(\"token\");\n        }\n      });\n    } else {\n      setUser(null);\n      setAuthenticated(false);\n      setLoading(false);\n    }\n  };\n\n  return { validateSession };\n}\n\nexport default useValidate;\n"]},"metadata":{},"sourceType":"module"}